import { Rule } from '@neonshapeshifter/logtower-engine';

export const ANTI_FORENSICS_RULES: Rule[] = [
  { "id": "AF_611_SDELETE_EXEC", "title": "SDelete Execution", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070.004"], "detection": { "selection": { "process.image": "*sdelete.exe" } } },
  { "id": "AF_612_SDELETE_WIPE", "title": "SDelete Free Space Wipe", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1485"], "detection": { "selection": { "process.image": "*sdelete.exe", "process.command_line": ["*-z*", "*-c*"] } } },
  { "id": "AF_613_SDELETE_RECURSIVE", "title": "SDelete Recursive Deletion", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1485"], "detection": { "selection": { "process.image": "*sdelete.exe", "process.command_line": ["*-s*", "*-q*"] } } },
  { "id": "AF_614_TIMESTOMP_MACE", "title": "Timestomp MACE Attributes", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070.006"], "detection": { "selection": { "process.command_line": ["*timestomp*", "*-m *", "*-a *", "*-c *", "*-e *"] } } },
  { "id": "AF_615_POWERSHELL_TIMESTOMP", "title": "PowerShell Timestomping", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070.006"], "detection": { "selection": { "process.command_line": ["*.CreationTime =", "*.LastWriteTime =", "*.LastAccessTime ="] } } },
  { "id": "AF_616_ATTRIBUTE_CHANGE", "title": "Attrib Hide/System", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1564.001"], "detection": { "selection": { "process.image": "*attrib.exe", "process.command_line": ["*+h*", "*+s*"] } } },
  { "id": "AF_617_FSUTIL_USN_DELETE", "title": "Fsutil Delete USN Journal", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1070.004"], "detection": { "selection": { "process.image": "*fsutil.exe", "process.command_line": ["*usn*", "*deletejournal*"] } } },
  { "id": "AF_618_WEVTUTIL_CLEAR_SEC", "title": "Wevtutil Clear Security Log", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1070.001"], "detection": { "selection": { "process.image": "*wevtutil.exe", "process.command_line": ["*cl*", "*Security*"] } } },
  { "id": "AF_619_WEVTUTIL_CLEAR_SYS", "title": "Wevtutil Clear System Log", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1070.001"], "detection": { "selection": { "process.image": "*wevtutil.exe", "process.command_line": ["*cl*", "*System*"] } } },
  { "id": "AF_620_WEVTUTIL_CLEAR_APP", "title": "Wevtutil Clear Application Log", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070.001"], "detection": { "selection": { "process.image": "*wevtutil.exe", "process.command_line": ["*cl*", "*Application*"] } } },
  { "id": "AF_621_WEVTUTIL_DISABLE", "title": "Wevtutil Disable Logging", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.002"], "detection": { "selection": { "process.image": "*wevtutil.exe", "process.command_line": ["*sl*", "*/e:false*"] } } },
  { "id": "AF_622_POWERSHELL_CLEAR_LOG", "title": "PowerShell Clear-EventLog", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1070.001"], "detection": { "selection": { "process.command_line": ["*Clear-EventLog*"] } } },
  { "id": "AF_623_VSSADMIN_DELETE", "title": "Vssadmin Delete Shadows", "severity": "CRITICAL", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.image": "*vssadmin.exe", "process.command_line": ["*delete*", "*shadows*"] } } },
  { "id": "AF_624_VSSADMIN_RESIZE", "title": "Vssadmin Resize ShadowStorage", "severity": "HIGH", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.image": "*vssadmin.exe", "process.command_line": ["*resize*", "*shadowstorage*"] } } },
  { "id": "AF_625_WMIC_SHADOW_DELETE", "title": "WMIC ShadowCopy Delete", "severity": "CRITICAL", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.command_line": ["*wmic*", "*shadowcopy*", "*delete*"] } } },
  { "id": "AF_626_WBADMIN_DELETE_CATALOG", "title": "WBAdmin Delete Catalog", "severity": "CRITICAL", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.image": "*wbadmin.exe", "process.command_line": ["*delete*", "*catalog*"] } } },
  { "id": "AF_627_WBADMIN_DELETE_BACKUP", "title": "WBAdmin Delete Backup", "severity": "CRITICAL", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.image": "*wbadmin.exe", "process.command_line": ["*delete*", "*backup*"] } } },
  { "id": "AF_628_BCDEDIT_RECOVERY", "title": "BCDEdit Disable Recovery", "severity": "CRITICAL", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.image": "*bcdedit.exe", "process.command_line": ["*recoveryenabled*", "*No*"] } } },
  { "id": "AF_629_BCDEDIT_IGNORE_FAILURES", "title": "BCDEdit Ignore Failures", "severity": "HIGH", "module": "IMPACT", "mitre": ["T1490"], "detection": { "selection": { "process.image": "*bcdedit.exe", "process.command_line": ["*bootstatuspolicy*", "*ignoreallfailures*"] } } },
  { "id": "AF_630_CIPHER_WIPE", "title": "Cipher Wipe Free Space", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1485"], "detection": { "selection": { "process.image": "*cipher.exe", "process.command_line": "*/w:*" } } },
  { "id": "AF_631_REG_DEL_MRU", "title": "Registry Delete MRU (Recent Docs)", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1112"], "detection": { "selection": { "process.image": "*reg.exe", "process.command_line": ["*delete*", "*RecentDocs*"] } } },
  { "id": "AF_632_REG_DEL_RUN", "title": "Registry Delete Run Key", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1112"], "detection": { "selection": { "process.image": "*reg.exe", "process.command_line": ["*delete*", "*RunMRU*"] } } },
  { "id": "AF_633_REG_DEL_TYPED_URLS", "title": "Registry Delete Typed URLs", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1112"], "detection": { "selection": { "process.image": "*reg.exe", "process.command_line": ["*delete*", "*TypedURLs*"] } } },
  { "id": "AF_634_CLEAR_RECYCLE_BIN", "title": "Clear Recycle Bin (Command Line)", "severity": "LOW", "module": "DEFENSE", "mitre": ["T1070"], "detection": { "selection": { "process.command_line": ["*Clear-RecycleBin*", "*rd /s /q C:$Recycle.Bin*"] } } },
  { "id": "AF_635_SYSMON_DRIVER_UNLOAD", "title": "Fltmc Unload Sysmon", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*fltmc.exe", "process.command_line": ["*unload*", "*SysmonDrv*"] } } },
  { "id": "AF_636_KILL_SYSMON", "title": "Taskkill Sysmon Service", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*taskkill.exe", "process.command_line": ["*Sysmon*", "*/f*"] } } },
  { "id": "AF_637_KILL_DEFENDER", "title": "Taskkill Defender Service", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*taskkill.exe", "process.command_line": ["*WinDefend*", "*/f*"] } } },
  { "id": "AF_638_SC_STOP_SYSMON", "title": "SC Stop Sysmon", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*sc.exe", "process.command_line": ["*stop*", "*Sysmon*"] } } },
  { "id": "AF_639_SC_DELETE_SYSMON", "title": "SC Delete Sysmon", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*sc.exe", "process.command_line": ["*delete*", "*Sysmon*"] } } },
  { "id": "AF_640_NET_STOP_SYSMON", "title": "Net Stop Sysmon", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*net.exe", "process.command_line": ["*stop*", "*Sysmon*"] } } },
  { "id": "AF_641_AUDITPOL_DISABLE", "title": "Auditpol Disable Success/Failure", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.002"], "detection": { "selection": { "process.image": "*auditpol.exe", "process.command_line": ["*/set*", "*/failure:disable*", "*/success:disable*"] } } },
  { "id": "AF_642_REG_DISABLE_AUDIT", "title": "Registry Disable Auditing", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1562.002"], "detection": { "selection": { "registry.target_object": "*\\Policies\\Microsoft\\Windows\\Audit*", "registry.details": "0" } } },
  { "id": "AF_643_DELETE_PREFETCH", "title": "Deletion of Prefetch Files", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070"], "detection": { "selection": { "process.command_line": ["*del*", "*\\Windows\\Prefetch*.pf"] } } },
  { "id": "AF_644_DELETE_AMCACHE", "title": "Deletion of Amcache", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1070"], "detection": { "selection": { "process.command_line": ["*del*", "*Amcache.hve*"] } } },
  { "id": "AF_645_DELETE_SHIMCACHE", "title": "Deletion of AppCompat Flags", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070"], "detection": { "selection": { "process.command_line": ["*reg*", "*delete*", "*AppCompatFlags*"] } } },
  { "id": "AF_646_POWERSHELL_HISTORY_DEL", "title": "PowerShell Delete History", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1070.003"], "detection": { "selection": { "process.command_line": ["*Remove-Item*", "*ConsoleHost_history.txt*"] } } },
  { "id": "AF_647_BASH_HISTORY_DEL", "title": "WSL Delete Bash History", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1070.003"], "detection": { "selection": { "process.command_line": ["*rm*", "*.bash_history*"] } } },
  { "id": "AF_648_ZONE_ID_STRIP", "title": "Stripping Zone.Identifier (MOTW)", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070"], "detection": { "selection": { "process.command_line": ["*Set-Content*", "*Zone.Identifier*", "*$null*"] } } },
  { "id": "AF_649_UNBLOCK_FILE", "title": "Unblock-File Usage", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1564.004"], "detection": { "selection": { "process.command_line": ["*Unblock-File*", "*-Path*"] } } },
  { "id": "AF_650_STREAMS_DELETE", "title": "Sysinternals Streams Delete", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1070"], "detection": { "selection": { "process.image": "*streams.exe", "process.command_line": "*-d*" } } },
  { "id": "AF_651_ADS_EXECUTION", "title": "Execution from ADS", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1564.004"], "detection": { "selection": { "process.image": "*:*:*" } } },
  { "id": "AF_652_MAKECAB_ADS", "title": "Makecab Hide in ADS", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1564.004"], "detection": { "selection": { "process.command_line": ["*makecab*", "*:*"] } } },
  { "id": "AF_653_EXPAND_ADS", "title": "Expand Hidden ADS", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1564.004"], "detection": { "selection": { "process.command_line": ["*expand*", "*:*"] } } },
  { "id": "AF_654_ESENTUTL_ADS", "title": "Esentutl Copy to ADS", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1564.004"], "detection": { "selection": { "process.image": "*esentutl.exe", "process.command_line": "*/y*:*" } } },
  { "id": "AF_655_CERTUTIL_DECODE_HIDDEN", "title": "Certutil Decode Hidden File", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1140"], "detection": { "selection": { "process.command_line": ["*certutil*", "*-decode*", "*hidden*"] } } },
  { "id": "AF_656_PNPUTIL_LOAD", "title": "PnpUtil Driver Load (BYOVD Prep)", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1127"], "detection": { "selection": { "process.image": "*pnputil.exe", "process.command_line": ["*/add-driver*", "*.sys*"] } } },
  { "id": "AF_657_DISM_REMOVE", "title": "DISM Remove Feature (Hardening)", "severity": "MEDIUM", "module": "IMPACT", "mitre": ["T1489"], "detection": { "selection": { "process.image": "*dism.exe", "process.command_line": ["*/Disable-Feature*", "*/Remove*"] } } },
  { "id": "AF_658_WUSA_UNINSTALL", "title": "WUSA Uninstall Update", "severity": "HIGH", "module": "DEFENSE", "mitre": ["T1562.001"], "detection": { "selection": { "process.image": "*wusa.exe", "process.command_line": "*/uninstall*" } } },
  { "id": "AF_659_FLTMC_FILTERS", "title": "Fltmc List Filters (Recon)", "severity": "LOW", "module": "DISCOVERY", "mitre": ["T1082"], "detection": { "selection": { "process.image": "*fltmc.exe", "process.command_line": "*filters*" } } },
  { "id": "AF_660_DRIVERQUERY_LIST", "title": "DriverQuery Recon", "severity": "LOW", "module": "DISCOVERY", "mitre": ["T1082"], "detection": { "selection": { "process.image": "*driverquery.exe" } } }
];
