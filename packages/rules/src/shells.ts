import { Rule } from '@neonshapeshifter/logtower-engine';

export const SHELLS_RULES: Rule[] = [
  { "id": "SH_711_PYTHON_REVERSE", "title": "Python Reverse Shell Pattern", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.006"], "detection": { "selection": { "process.image": "*python*.exe", "process.command_line": ["*-c*", "*import socket*", "*subprocess*"] } } },
  { "id": "SH_712_PYTHON_PTY", "title": "Python PTY Spawn", "severity": "HIGH", "module": "EXECUTION", "mitre": ["T1059.006"], "detection": { "selection": { "process.command_line": ["*import pty*", "*pty.spawn*"] } } },
  { "id": "SH_713_PERL_REVERSE", "title": "Perl Reverse Shell Pattern", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.006"], "detection": { "selection": { "process.image": "*perl*.exe", "process.command_line": ["*-e*", "*use Socket*", "*connect*"] } } },
  { "id": "SH_714_RUBY_REVERSE", "title": "Ruby Reverse Shell Pattern", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.006"], "detection": { "selection": { "process.image": "*ruby*.exe", "process.command_line": ["*-e*", "*require 'socket'*", "*TCPSocket*"] } } },
  { "id": "SH_715_LUA_REVERSE", "title": "Lua Reverse Shell Pattern", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.006"], "detection": { "selection": { "process.image": "*lua*.exe", "process.command_line": ["*-e*", "*require('socket')*", "*connect*"] } } },
  { "id": "SH_716_PHP_REVERSE", "title": "PHP Reverse Shell Pattern", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.006"], "detection": { "selection": { "process.image": "*php*.exe", "process.command_line": ["*-r*", "*fsockopen*", "*exec*"] } } },
  { "id": "SH_717_NC_EXEC_SHELL", "title": "Netcat Execute Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": ["*nc.exe", "*nc64.exe"], "process.command_line": ["*-e*", "*cmd.exe*"] } } },
  { "id": "SH_718_NCAT_EXEC_SHELL", "title": "Ncat Execute Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*ncat.exe", "process.command_line": ["*--exec*", "*cmd.exe*"] } } },
  { "id": "SH_719_SOCAT_EXEC", "title": "Socat Exec Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*socat.exe", "process.command_line": ["*exec:*", "*cmd.exe*"] } } },
  { "id": "SH_720_OPENSSL_SHELL", "title": "OpenSSL Reverse Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*openssl.exe", "process.command_line": ["*s_client*", "*-quiet*", "*connect*"] } } },
  { "id": "SH_721_TELNET_CLIENT", "title": "Telnet Client Usage", "severity": "MEDIUM", "module": "COMMAND_AND_CONTROL", "mitre": ["T1095"], "detection": { "selection": { "process.image": "*telnet.exe" } } },
  { "id": "SH_722_SSH_CLIENT_EXEC", "title": "SSH Client Command Exec", "severity": "MEDIUM", "module": "LATERAL", "mitre": ["T1021.004"], "detection": { "selection": { "process.image": "*ssh.exe", "process.command_line": "*@*" } } },
  { "id": "SH_723_PLINK_EXEC", "title": "Plink Command Exec", "severity": "HIGH", "module": "LATERAL", "mitre": ["T1021.004"], "detection": { "selection": { "process.image": "*plink.exe", "process.command_line": ["*-pw*", "*-m*"] } } },
  { "id": "SH_724_PUTTY_CLI", "title": "Putty CLI Usage", "severity": "LOW", "module": "LATERAL", "mitre": ["T1021.004"], "detection": { "selection": { "process.image": "*putty.exe", "process.command_line": ["*-ssh*", "*-pw*"] } } },
  { "id": "SH_725_AWK_REVERSE", "title": "Awk Reverse Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*awk.exe", "process.command_line": ["*BEGIN*", "*Socket*"] } } },
  { "id": "SH_726_GAWK_REVERSE", "title": "Gawk Reverse Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*gawk.exe", "process.command_line": ["*BEGIN*", "*Socket*"] } } },
  { "id": "SH_727_JAVA_REVERSE", "title": "Java Reverse Shell Class", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*java.exe", "process.command_line": ["*Runtime*", "*exec*", "*cmd.exe*"] } } },
  { "id": "SH_728_NODE_REVERSE", "title": "NodeJS Reverse Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*node.exe", "process.command_line": ["*-e*", "*child_process*", "*spawn*"] } } },
  { "id": "SH_729_DENO_REVERSE", "title": "Deno Reverse Shell", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059"], "detection": { "selection": { "process.image": "*deno.exe", "process.command_line": ["*run*", "*--allow-net*", "*subprocess*"] } } },
  { "id": "SH_730_POWERSHELL_TCP_CLIENT", "title": "PowerShell TCP Client (Raw)", "severity": "HIGH", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.001"], "detection": { "selection": { "process.command_line": ["*New-Object*", "*Net.Sockets.TcpClient*"] } } },
  { "id": "SH_731_POWERSHELL_UDP_CLIENT", "title": "PowerShell UDP Client (Raw)", "severity": "HIGH", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.001"], "detection": { "selection": { "process.command_line": ["*New-Object*", "*Net.Sockets.UdpClient*"] } } },
  { "id": "SH_732_BASH_REVERSE", "title": "Bash Reverse Shell (WSL)", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.004"], "detection": { "selection": { "process.image": "*bash.exe", "process.command_line": ["*-i*", "*&*", "*/dev/tcp/*"] } } },
  { "id": "SH_733_SH_REVERSE", "title": "Sh Reverse Shell (WSL)", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.004"], "detection": { "selection": { "process.image": "*sh.exe", "process.command_line": ["*-i*", "*&*", "*/dev/tcp/*"] } } },
  { "id": "SH_734_ZSH_REVERSE", "title": "Zsh Reverse Shell (WSL)", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1059.004"], "detection": { "selection": { "process.image": "*zsh.exe", "process.command_line": ["*zsh/net/tcp*"] } } },
  { "id": "SH_735_CHISEL_SERVER", "title": "Chisel Server Mode", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1572"], "detection": { "selection": { "process.command_line": ["*chisel*", "*server*", "*--reverse*"] } } },
  { "id": "SH_736_CHISEL_CLIENT_CONNECT", "title": "Chisel Client Connect", "severity": "CRITICAL", "module": "COMMAND_AND_CONTROL", "mitre": ["T1572"], "detection": { "selection": { "process.command_line": ["*chisel*", "*client*", "*R:*:*"] } } },
  { "id": "SH_737_GOST_PROXY", "title": "Gost Proxy Execution", "severity": "HIGH", "module": "COMMAND_AND_CONTROL", "mitre": ["T1090"], "detection": { "selection": { "process.image": "*gost.exe", "process.command_line": ["*-L*", "*-F*"] } } },
  { "id": "SH_738_YAGM_PROXY", "title": "Yagm Proxy Execution", "severity": "HIGH", "module": "COMMAND_AND_CONTROL", "mitre": ["T1090"], "detection": { "selection": { "process.image": "*yagm.exe" } } },
  { "id": "SH_739_3PROXY_EXEC", "title": "3Proxy Execution", "severity": "HIGH", "module": "COMMAND_AND_CONTROL", "mitre": ["T1090"], "detection": { "selection": { "process.image": "*3proxy.exe" } } },
  { "id": "SH_740_STUNNEL_EXEC", "title": "Stunnel Execution", "severity": "MEDIUM", "module": "COMMAND_AND_CONTROL", "mitre": ["T1573.002"], "detection": { "selection": { "process.image": "*stunnel.exe" } } },
  { "id": "SH_741_RSYNC_EXEC", "title": "Rsync Data Transfer", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*rsync.exe" } } },
  { "id": "SH_742_SCP_EXEC", "title": "SCP Data Transfer", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*scp.exe" } } },
  { "id": "SH_743_SFTP_EXEC", "title": "SFTP Data Transfer", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*sftp.exe" } } },
  { "id": "SH_744_FTP_SCRIPT", "title": "FTP Script Execution", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*ftp.exe", "process.command_line": ["*-s:*", "*-i*"] } } },
  { "id": "SH_745_TFTP_GET", "title": "TFTP Get File", "severity": "MEDIUM", "module": "COMMAND_AND_CONTROL", "mitre": ["T1105"], "detection": { "selection": { "process.image": "*tftp.exe", "process.command_line": ["*-i*", "*GET*"] } } },
  { "id": "SH_746_TFTP_PUT", "title": "TFTP Put File", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*tftp.exe", "process.command_line": ["*-i*", "*PUT*"] } } },
  { "id": "SH_747_CURL_UPLOAD", "title": "Curl Upload File", "severity": "HIGH", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*curl.exe", "process.command_line": ["*-T*", "*--upload-file*"] } } },
  { "id": "SH_748_CURL_POST", "title": "Curl POST Data", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*curl.exe", "process.command_line": ["*-d*", "*--data*"] } } },
  { "id": "SH_749_WGET_POST", "title": "Wget POST File", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*wget.exe", "process.command_line": ["*--post-file*"] } } },
  { "id": "SH_750_CERTUTIL_POST", "title": "Certutil POST (Not Standard)", "severity": "HIGH", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.image": "*certutil.exe", "process.command_line": ["*-ping*", "*-config*"] } } },
  { "id": "SH_751_POWERSHELL_IWR_POST", "title": "PowerShell IWR POST", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.command_line": ["*Invoke-WebRequest*", "*-Method Post*"] } } },
  { "id": "SH_752_POWERSHELL_IRM_POST", "title": "PowerShell IRM POST", "severity": "MEDIUM", "module": "EXFILTRATION", "mitre": ["T1048"], "detection": { "selection": { "process.command_line": ["*Invoke-RestMethod*", "*-Method Post*"] } } },
  { "id": "SH_753_RUNDLL32_JAVASCRIPT", "title": "Rundll32 JavaScript Shell", "severity": "CRITICAL", "module": "EXECUTION", "mitre": ["T1059.007"], "detection": { "selection": { "process.command_line": ["*rundll32*", "*javascript:*", "*RunHTMLApplication*"] } } },
  { "id": "SH_754_MSHTA_VBSCRIPT", "title": "Mshta VBScript Shell", "severity": "CRITICAL", "module": "EXECUTION", "mitre": ["T1059.005"], "detection": { "selection": { "process.command_line": ["*mshta*", "*vbscript:*", "*execute*"] } } },
  { "id": "SH_755_MSHTA_JAVASCRIPT", "title": "Mshta JavaScript Shell", "severity": "CRITICAL", "module": "EXECUTION", "mitre": ["T1059.007"], "detection": { "selection": { "process.command_line": ["*mshta*", "*javascript:*", "*Run*"] } } },
  { "id": "SH_756_REGASM_CODE", "title": "RegAsm Code Execution", "severity": "HIGH", "module": "EXECUTION", "mitre": ["T1218.009"], "detection": { "selection": { "process.image": "*regasm.exe", "process.command_line": ["*/U*", "*/nologo*"] } } },
  { "id": "SH_757_REGKSVCS_CODE", "title": "RegSvcs Code Execution", "severity": "HIGH", "module": "EXECUTION", "mitre": ["T1218.009"], "detection": { "selection": { "process.image": "*regsvcs.exe", "process.command_line": ["*/U*", "*/nologo*"] } } },
  { "id": "SH_758_INSTALLUTIL_CODE", "title": "InstallUtil Code Execution", "severity": "HIGH", "module": "EXECUTION", "mitre": ["T1218.004"], "detection": { "selection": { "process.image": "*installutil.exe", "process.command_line": ["*/logfile=*", "*/U*"] } } },
  { "id": "SH_759_DFSVC_CODE", "title": "Dfsvc Code Execution", "severity": "MEDIUM", "module": "DEFENSE", "mitre": ["T1127"], "detection": { "selection": { "process.image": "*dfsvc.exe" } } },
  { "id": "SH_760_IEEXEC_CODE", "title": "IEExec Code Execution", "severity": "CRITICAL", "module": "DEFENSE", "mitre": ["T1127"], "detection": { "selection": { "process.image": "*ieexec.exe", "process.command_line": "*http:*" } } }
];
